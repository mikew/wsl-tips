#!/usr/bin/env bash
set -e

source "$(dirname "$0")/wsl-systemd-env"

SYSTEMD_PID=$(wsl-systemd-get-pid)

if [ -n "$SYSTEMD_PID" ] && [ "$SYSTEMD_PID" != "1" ]; then
  exec /usr/bin/nsenter \
    -t "$SYSTEMD_PID" \
    -a \
      runuser \
      -l \
      -s "$WSL_SYSTEMD_SHELL" \
      "$WSL_SYSTEMD_USER"
fi
